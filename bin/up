#!/usr/bin/env bash

cp example.env .env
docker compose up --no-color --quiet-pull --detach --remove-orphans
docker compose exec minio /usr/bin/mc ready local
docker compose exec minio /usr/bin/mc alias set local http://localhost:9000 minioadmin minioadmin
docker compose exec minio /usr/bin/mc mb local/tansu
mkdir -p venvs
test -d venvs/dev || uv --no-progress venv -p 3.12 venvs/dev
RUN echo "source venvs/dev/bin/activate" >> /root/.bashrc
source venvs/dev/bin/activate
uv --no-progress pip install kafka-python
